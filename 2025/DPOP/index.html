<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> DPOP | nicopedia </title> <meta name="author" content="Nico Porsch"> <meta name="description" content="Summary of Dynamic Programming and Optimal Control course at ETH Zürich"> <link rel="stylesheet" href="/nicopedia/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/nicopedia/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/nicopedia/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/nicopedia/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/nicopedia/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%93%9A&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/nicopedia/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://nicop111.github.io/nicopedia/2025/DPOP/"> <script src="/nicopedia/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/nicopedia/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/nicopedia//"> nicopedia </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/nicopedia/"> </a> </li> <li class="nav-item "> <a class="nav-link" href="/nicopedia/about/">about </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">DPOP</h1> <p class="post-meta"> Created in January 09, 2025 </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2025   ·   <i class="fa-solid fa-hashtag fa-sm"></i> Optimal Control   <i class="fa-solid fa-hashtag fa-sm"></i> Dynamic Programming   <i class="fa-solid fa-hashtag fa-sm"></i> Bellman Equation   ·   <i class="fa-solid fa-tag fa-sm"></i> Uni Courses </p> </header> <article class="post-content"> <div id="table-of-contents"> <ul id="toc" class="section-nav"> <li class="toc-entry toc-h1"> <a href="#discrete-time-systems">Discrete-time Systems</a> <ul> <li class="toc-entry toc-h2"><a href="#discrete-state-systems">Discrete-state Systems</a></li> <li class="toc-entry toc-h2"> <a href="#non-standard-problems">Non-standard Problems</a> <ul> <li class="toc-entry toc-h3"><a href="#time-lags">Time lags</a></li> <li class="toc-entry toc-h3"><a href="#correlated-disturbances">Correlated Disturbances</a></li> <li class="toc-entry toc-h3"><a href="#forecasts">Forecasts</a></li> </ul> </li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#finite-horizon-problems">Finite Horizon Problems</a> <ul> <li class="toc-entry toc-h2"><a href="#open-loop-vs-closed-loop-control">Open-loop vs. Closed-loop control</a></li> <li class="toc-entry toc-h2"><a href="#principle-of-optimality">Principle of Optimality</a></li> <li class="toc-entry toc-h2"><a href="#the-dynamic-programming-algorithm">The Dynamic Programming Algorithm</a></li> <li class="toc-entry toc-h2"><a href="#deterministic-finite-state-systems-and-the-shortest-path-problem">Deterministic Finite State Systems and the Shortest Path Problem</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#infinite-horizon-problems">Infinite Horizon Problems</a> <ul> <li class="toc-entry toc-h2"><a href="#value-iteration">Value Iteration</a></li> <li class="toc-entry toc-h2"><a href="#policy-iteration">Policy Iteration</a></li> <li class="toc-entry toc-h2"><a href="#linear-programming">Linear Programming</a></li> </ul> </li> <li class="toc-entry toc-h1"> <a href="#deterministic-continuous-time-problems">Deterministic Continuous Time Problems</a> <ul> <li class="toc-entry toc-h3"><a href="#pontyagins-minimum-principle">Pontyagin’s Minimum Principle</a></li> </ul> </li> </ul> </div> <hr> <div id="markdown-content"> <blockquote class="notice--danger"> <p>This post is work in progress</p> </blockquote> <h1 id="discrete-time-systems">Discrete-time Systems</h1> <p>The dynamics of a discrete-time system in standard form are given by</p> \[x_{k+1} = f_k(x_k, u_k, w_k), \quad k = 0,...,N-1\label{eq:discrete_system}\] <ul> <li>\(x_k \in \mathcal{S}_k\) - System state at time \(k\), where \(\mathcal{S}_k\) are possible states at that time</li> <li>\(u_k \in \mathcal{U}_k(x_k)\) - Control input at time \(k\). The set of allowable inputs \(\mathcal{U}_k(x_k)\) can depend on the state itself.</li> <li>\(w_k\) - Disturbance at time \(k\) whose probability distribution \(p_{w_k \mid x_k, u_k} (\bullet \mid x_k, u_k)\) is given. In particular it is independent of all prior \(x_l, u_l, w_l, l &lt; k\).</li> <li>\(N\) - Time horizon</li> </ul> <h2 id="discrete-state-systems">Discrete-state Systems</h2> <p>This section introduces Systems, where the time and the state-space is discrete (also known as Markov Decision Processes). If furthermore the state space is finite we call them finite-state Systems. Generally in \eqref{eq:discrete_system} the states live in a continuous space. If they are discrete we can use an alternative way to describe the system, that is transition probabilities</p> \[P_{ij}(u,k) = \text{Pr}(x_{k+1} = j | x_k=i,u_k=u) = p_{x_{k+1} | x_k,u_k}(j|i,u)\] <p>where \(p_{x_k+1 | x_k,u_k}(\cdot|\cdot,\cdot)\) denotes the probability of $x_{k+1}$ given $x_k$ and $u_k$. In other words it describes the probability to get us from state $i$ to state $j$ with control input $u$ at time $k$. This is equivalent to the system \(x_{k+1} = w_k\) where $w_k$ has the probability distribution \(p_{w_k | x_k,u_k}(j|i,u)\).</p> <p>If \eqref{eq:discrete_system} is a discrete-state system, its transition probabilities are</p> \[P_{ij}(u,k) = \sum_{\{\bar w_k | f_k(i,u,\bar w_k) = j\}} p_{w_k | x_k,u_k}(\bar w_k |i,u)\] <h2 id="non-standard-problems">Non-standard Problems</h2> <p>Some problems are not given in the general form, but can be reformulated as such.</p> <h3 id="time-lags">Time lags</h3> <p>If the dynamics are of the form \(x_{k+1} = f_k(x_k, x_{k-1}, u_k, u_{k-1}, w_k)\) we can construct a state vector \(\tilde x_k := (x_k, y_k, s_k)\) and modify the dynamics like</p> \[\tilde x_{k+1} = \tilde f_k(\tilde x_k, u_k, w_k) = \left[\begin{matrix} f_k(x_k, y_k, u_k, s_k, w_k)\\ x_k\\ u_k \end{matrix}\right]\] <p>yielding a system in standard form. For even longer time lags we just introduce more variables in the augmented state.</p> <h3 id="correlated-disturbances">Correlated Disturbances</h3> <p>Disturbances \(w_k\) correlated over time can sometimes be modeled as</p> \[y_{k+1} = A_k y_k + \xi_k , \quad w_k = C_ky_{k+1}\] <p>Where \(A_k\) and \(C_k\) are given and \(\xi_k\) are independent random variables. Then we can augment the state as \(\tilde x_k = (x_k, y_k)\) and update the dynamics:</p> \[\tilde x_{k+1} = \tilde f_k(\tilde x_k, u_k, \xi_k) = \begin{bmatrix} f_k(x_k, u_k, C_k(A_ky_k + \xi_k))\\ A_ky_k + \xi_k \end{bmatrix}\] <h3 id="forecasts">Forecasts</h3> <p>The disturbance’s probability distribution is dependent on a forecast \(y_k\) that is known at each timestep: \(w_k \sim p_{w_k|y_k}(\cdot | i)\). The forecast itself gets determined in the prior time step by a random variable \(y_{k+1} = \xi_k\) that has a given a priori distribution \(\xi_k \sim p_{\xi_k}(i)\). It is in particular independent of all states, inputs and disturbances.</p> <p>We augmented the state vector \(\tilde x_k = (x_k, y_k)\) and the disturbance \(\tilde w_k = (w_k, \xi_k)\) with distribution \(p(\tilde w_k|\tilde x_k, u_k) = p(w_k|y_k)p(\xi_k)\). This gives us the dynamics in standard form:</p> \[\tilde x_{k+1} = \tilde f_k(\tilde x_k, u_k, \tilde w_k) = \begin{bmatrix} f_k(x_k, u_k, w_k)\\ \xi_k \end{bmatrix}\] <hr> <h1 id="finite-horizon-problems">Finite Horizon Problems</h1> <p>Given an initial state \(x_0\) our goal is to find an optimal control input to the system \(\ref{eq:discrete_system}\), that minimizes the cost function</p> \[\underbrace{g_N(x_N)}_{\text{terminal cost}} + \underbrace{\sum_{k=0}^{N-1}\underbrace{g_k(x_k,u_k,w_k)}_\text{stage cost}}_\text{accumulated cost} \label{eq:cost_function}\] <p>while the horizon \(N\) is finite. Notice that \(W_0 = (w_0,...,w_{N-1})\) are random variables and thereby \(X_1 = (x_1,...,x_{N})\) are generally random variables as well, because they are correlated through the system dynamics. We therefore define the expected cost as</p> \[\text{E}_{(X_1,W_0|x_0)} \left[ g_N(x_N) + \sum_{k=0}^{N-1}g_k(x_k,u_k,w_k) \right] \label{eq:exp_cost}\] <h2 id="open-loop-vs-closed-loop-control">Open-loop vs. Closed-loop control</h2> <p><strong>Open-loop control</strong> means, there is no feedback and the entire control sequence is determined in the beginning. Given an initial state \(x_0\), we search a fixed sequence of control inputs \(U = (u_0,...,u_{N-1})\) that minimizes \(\ref{eq:exp_cost}\).</p> <p>In <strong>Closed-loop control</strong> at each timestep we know the current state. A policy \(\pi = (\mu_0(\cdot), ..., \mu_{N-1}(\cdot))\) maps each state at every timestep to a control input \(u_k = \mu_k(x_k)\in\mathcal{U}_k(x_k)\). Thus there is a feedback from the current state to the control input. Given an initial state \(x_0\), the expected cost associated with \(\pi\) becomes</p> \[J^\pi(x_0) = \text{E}_{(X_1,W_0|x_0)} \left[ g_N(x_N) + \sum_{k=0}^{N-1}g_k(x_k,\mu_k(x_k),w_k) \right] \label{eq:policy_exp_cost}\] <p>We look for an optimal policy \(\pi^*\) which minimizes the expected cost, yielding the optimal cost \(J^*(x) := J^{\pi^*}(x) \leq J^\pi(x), \forall \pi, \forall x\in\mathcal{S}_0.\)</p> <p>Without disturbance the system, and thus the cost, becomes deterministic. There is no benefit in a feedback, i.e. Open-loop and Closed-loop control are equivalent.</p> <h2 id="principle-of-optimality">Principle of Optimality</h2> <p>The Principle of Optimality makes it possible to split up the optimization problem into smaller subproblems. Casually speaking, when you have an optimal policy from time \(0\) to the end, then the policy is also optimal from an arbitrary time \(i\) to the end.</p> <blockquote class="notice--info"> <p>Let \(\pi^* = (\mu_0^*(\cdot), ..., \mu_i^*(\cdot), ..., \mu_{N-1}^*(\cdot))\) be an optimal policy. Consider the subproblem whereby we are at \(x_i \in S_i\) at time \(i\) with \(X_{i+1} = (x_{i+1},...,x_{N})\) and \(W_{i} = (x_i,...,x_{N})\). We want to minimize the cost from this time-step up until the end of the original problem</p> \[J_i(x_i) = \text{E}_{(X_{i+1},W_i|x_i)} \left[ g_N(x_N) + \sum_{k=i}^{N-1}g_k(x_k,\mu_k(x_k),w_k) \right]\] <p>Then the truncated policy \((\mu_i^*(\cdot), ..., \mu_{N-1}^*(\cdot))\) is optimal for the subproblem and for all possible \(x_i\). If it wasn’t, there would exist a policy yielding a lower cost on at least some portion of the state space. But this contradicts that \(\pi^*\) was an optimal policy in the first place.</p> </blockquote> <h2 id="the-dynamic-programming-algorithm">The Dynamic Programming Algorithm</h2> <p>Dynamic Programming uses the Principle of Optimality to recursively compute an optimal closed-loop policy and an optimal cost. Beginning from the terminal states at time N, going backwards towards time step 0.</p> <blockquote class="notice--info"> <p>Initialization</p> \[J_N(x) = g_N(x), \quad \forall x \in \mathcal{S}_N\] <p>Recursion \(k=(N-1),...,0\): For each \(x_k \in \mathcal{S}_k\) compute</p> \[J_k(x_k) = \min_{u\in\mathcal{U}_k(x)} \text{E}_{(w_k | x_k=x,u=u)} \left[ g_k(x_k,u,w_k) + J_{k+1}(f_k(x_k,u,w_k)) \right]\] <p>This gives us the optimal cost function \(J^*(x_0) = J_0(x_0)\). Furthermore the minimizing \(u^∗ =: µ^*_k (x_k)\) yields the optimal policy \(π^∗ = (µ^∗_0 (·) , µ^∗_1 (·) , . . . , µ^∗_{N −1} (·))\)</p> </blockquote> <h2 id="deterministic-finite-state-systems-and-the-shortest-path-problem">Deterministic Finite State Systems and the Shortest Path Problem</h2> <p>A Deterministic Finite State System is a special case of the discrete-state system: Namely the number of states is finite \(|S_k|&lt;\infty\). Furthermore the system is deterministic i.e. it has no disturbance \(w_k = 0\), which means we know exactly how our system will evolve given a certain input. As shown later, these DFS systems are equivalent to the Shortest Path Problem.</p> <hr> <h1 id="infinite-horizon-problems">Infinite Horizon Problems</h1> <p>Bellman equation</p> <p>In the following we will exlusively deal with <a href="#discrete-state-systems">Finite-state Systems</a> and we want to minimize the expected cost as $N$ goes to infinity.</p> <h2 id="value-iteration">Value Iteration</h2> <h2 id="policy-iteration">Policy Iteration</h2> <h2 id="linear-programming">Linear Programming</h2> <hr> <h1 id="deterministic-continuous-time-problems">Deterministic Continuous Time Problems</h1> <p>Bellmann Equation</p> \[123\] <h3 id="pontyagins-minimum-principle">Pontyagin’s Minimum Principle</h3> <p>Extra: How to derive the LQR from Pontyagins Principle</p> </div> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Nico Porsch. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/nicopedia/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/nicopedia/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/nicopedia/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/nicopedia/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/nicopedia/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/nicopedia/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/nicopedia/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/nicopedia/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/nicopedia/assets/js/mathjax-setup.js?70d799092f862ad98c7876aa47712e20"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/nicopedia/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/nicopedia/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/nicopedia/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/nicopedia/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/nicopedia/assets/js/search-data.js"></script> <script src="/nicopedia/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>